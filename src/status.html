<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>

	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="author" content="Joseph Chow" />
	<meta name="description" content="btc relay, bitcoin, ethereum, bitcoin relay,smart sontracts, sidechain, peg" />

	<link rel="apple-touch-icon" sizes="57x57" href="images/favicons/apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="images/favicons/apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/favicons/apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="images/favicons/apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/favicons/apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="images/favicons/apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="images/favicons/apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="images/favicons/apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="images/favicons/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192"  href="images/favicons/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="images/favicons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="images/favicons/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="images/favicons/favicon-16x16.png">
	<link rel="manifest" href="images/favicons/manifest.json">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="images/favicons/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">

	<link href='https://fonts.googleapis.com/css?family=Lato:400,300,300italic,400italic,700,700italic|Montserrat:400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="css/all.min.css" type="text/css" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<!--[if lt IE 9]>
		<script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
	<![endif]-->

	<title>BTC Relay status</title>

</head>

<body>

	<div class="side-cover-wrapper full-screen">
	</div>

	<!-- Document Wrapper -->
	<div id="wrapper" class="clearfix">

		<!-- Header -->
		<header id="header" class="nobottomborder no-sticky">

			<div id="header-wrap">

				<div class="container-fluid clearfix">

					<div id="primary-menu-trigger"><i class="icon-reorder"></i></div>

					<!-- Logo -->
					<div id="logo">
					</div>

					<!-- Primary Navigation -->
					<nav id="primary-menu" class="style-2">

						<!--ul>
							<li><a href="#" data-scrollto="#section-about" data-easing="easeInOutExpo" data-speed="1250" data-offset="200"><div>About</div></a></li>
							<li><a href="#" data-scrollto="#section-services" data-easing="easeInOutExpo" data-speed="1250" data-offset="60"><div>Services</div></a></li>
							<li><a href="#" data-scrollto="#section-portfolio" data-easing="easeInOutExpo" data-speed="1250" data-offset="60"><div>Portfolio</div></a></li>
							<li><a href="#" data-scrollto="#section-contact" data-easing="easeInOutExpo" data-speed="1250" data-offset="60"><div>Contact</div></a></li>
						</ul-->

					</nav><!-- #primary-menu end -->

				</div>

			</div>

		</header><!-- #header end -->

		<div class="clear"></div>

		<!-- Content -->
		<section id="content">

			<div class="content-wrap">

				<div id="section-about" class="container-fluid page-section clearfix">

					<!-- <div class="line topmargin-lg bottommargin-lg"></div> -->

          <h2>BETA <a href="https://github.com/ethereum/btcrelay#btc-relay">Ethereum Bitcoin Relay</a></h2>
          <h3>Address: <strong id="relayAddr"></strong></h3>
          <h3><a href="./BitcoinRelayABI.js">ABI</a></h3>
					<h3><a href="https://github.com/ethereum/btcrelay#api">API</a></h3>
          <h3>Latest Block Hash: <strong id="latestBlockHash"></strong></h3>
          <div>
            <h3 style="display: inline-block">Latest Block#: <strong id="latestBlockHeight"></strong></h3>
            <div style="display: inline-block; margin-left:3em"><a href="https://blockchain.info" target="_">blockchain.info</a>: <strong id="bciBlockHeight"></strong></div>
            <span><a href="https://btc.blockr.io" target="_">btc.blockr.io</a>: <strong id="blockrBlockHeight"></strong></span>
          </div>
          <h3 id="warnSync" style="display: none">Your Ethereum node may not be fully synced: <span id=nodeBlockNum></span>.  Check <a href="https://stats.ethdev.com" target="_">stats</a>
            for the latest blocks.
          </h3>
          <h3>ETH fee: <strong id="feeVTX"></strong></h3>
          <h5>Relayer: <strong id="feeRecipient"></strong></h5>

				</div>

			</div>

		</section><!-- #content end -->

		<!-- Footer -->
		<footer id="footer" class="dark">
			<div id="copyrights" style="background-color:#111;">
				<div class="container-fluid">
					BTC Relay is licensed under the <a href="https://github.com/ethereum/btcrelay/blob/master/LICENSE" target="_blank">MIT License</a>. &nbsp; Check it out on <a href="https://github.com/ethereum/btcrelay" target="_blank">Github</a>.

					<div class="pull-right">info [at] btcrelay.org</div>

				</div>
			</div>
		</footer><!-- #footer end -->

	</div><!-- #wrapper end -->

	<!-- Footer Scripts  -->
	<script type="text/javascript" src="js/all.min.js"></script>
	<script>
	var web3 = require('web3');
	web3.setProvider(new web3.providers.HttpProvider('http://frontier-lb.ether.camp'));

	var heightPerRelay;


	  /*
	    do NOT forget to update ABI files when needed
	   */

	   var relayAddr = '0x41f274c0023f83391de4e0733c609df5a124c3d4'; // Alpha Frontier

	  // var relayAddr = web3.eth.namereg.addr('btcrelay');  // Olympic
	  $('#relayAddr').text(relayAddr);


	  updateBCI();
	  updateBlockr();

	  var RelayContract = web3.eth.contract(btcRelayAbi);  // see ./js/btcRelayAbi.js
	  var contract = RelayContract.at(relayAddr);

	  heightPerRelay = contract.getLastBlockHeight.call().toString();
	  $('#latestBlockHeight').text(heightPerRelay);

	  var headHash = contract.getBlockchainHead.call();
	  $('#latestBlockHash').text(formatHash(headHash));

	  var feeVTX = web3.fromWei(contract.getFeeAmount.call(headHash), 'ether');
	  $('#feeVTX').text(feeVTX);

	  var feeRecipient = contract.getFeeRecipient.call(headHash).toString(16);
	  $('#feeRecipient').text('0x' + feeRecipient);

	  window.btcrelayTester = contract;
	  // signature of verifyTx is (txHash, txIndex, merkleSiblingArray, txBlockHash)
	  // to make a call to verifyTx so that btcrelay will get some fees,
	  // run this code in the browser developer console: fees will be sent
	  // from the coinbase
	  // res = btcrelayTester.verifyTx.sendTransaction(0, 1, [], 0, {from: web3.eth.coinbase, value: web3.toWei('0.1', 'ether')});
	  // console.log('txHash for verifyTx: ', res)


	  //setTimeout(checkHeights, 1000);


	function updateBCI() {
	  // 2 calls needed since https://blockchain.info/latestblock is missing CORS
	  $.getJSON('https://blockchain.info/q/getblockcount?cors=true', function(data) {
	    $('#bciBlockHeight').text(data);
	  });

	  // https://github.com/blockchain/api-v1-client-python/issues/17
	  // $.getJSON('https://blockchain.info/q/latesthash?cors=true', function(data) {
	  //   $('#bciBlockHash').text(data);
	  // });
	}

	function updateBlockr() {
	  $.getJSON('http://btc.blockr.io/api/v1/block/info/last', function(data) {
	    $('#blockrBlockHeight').text(data.data.nb);
	  });
	}

	function checkHeights() {
	  var bciHeight = $('#bciBlockHeight').text();
	  var blockrHeight = $('#blockrBlockHeight').text();
	  if (!bciHeight || !blockrHeight ||
	    heightPerRelay === bciHeight || heightPerRelay === blockrHeight) {
	      $('#warnSync').hide();
	  }
	  else {
	    $('#nodeBlockNum').text(web3.eth.blockNumber);
	    $('#warnSync').show();
	  }
	}

	function formatHash(bnHash) {
	  var hash = bnHash.toString(16);
	  return Array(64 - hash.length + 1).join('0') + hash;
	}
	</script>

	<!-- GA  -->
	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69981046-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>
